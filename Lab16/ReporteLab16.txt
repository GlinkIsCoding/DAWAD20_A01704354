
Guillermo Carlos Espino Mateos - A01704354

-------------- Reporte Lab 16 -------------

--------------INVESTIGACIÓN----------------

############## ORACLE #####################

- Requerimientos Generales de Hardware

AMD Opteron, Intel Pentium® at 500 MHz or faster, or Intel EM64T
Minimum 500 MB free disk space for installation, 10 GB recommended
Minimum 1 GB physical memory, 4 GB recommended

- Ambientes o plataformas en las que pueden operar.

Windows Server 2003 SP2
Windows Server 2003 R2+
Windows Server 2008 SP1+
Windows XP SP2+
Windows 7
Solaris 9 Update 9+
Solaris 10 Update 4+
Oracle Linux 4 (UL7+)
Oracle Linux 5 (UL3+)
Red Hat Enterprise Linux 4 (UL7+)
Red Hat Enterprise Linux 5 (UL3+)
SUSE Linux Enterprise Server 10 (SP1+)
SUSE Linux Enterprise Server 11 (all SP levels)

- Costos de implementación y mantenimiento.

Oracle ofrece sus servicios por un valor de entre $92-$460 USD para uso personal y $4,750-$47,500 USD para uso empresarial.

- Ventajas y desventajas de su uso.

Ventajas: Siempre tendrán las innovaciones de vanguardia y features en sus productos puesto que Oracle tiende a poner la vara para otros DBMS.
Las herramientas son increíblemente robustas y puedes encontrar una que haga exactamente lo que necesitas.

Desventajas: El costo de Oracle puede ser muy alto, especialmente para organizaciones pequeñas.
El sistema puede requerir muchos recursos una vez que se instala, así que las mejoras de hardware pueden ser requeridas solo para implementar Oracle.

- Porcentaje del mercado que controlan

5.92%

############## SQL Server #####################

- Requerimientos Generales de Hardware

Hard Disk 6 GB of available hard-disk space.
Memory Minimum:
Express Editions: 512 MB
All other editions: 1 GB
Memory Recommended:
Express Editions: 1 GB
All other editions: At least 4 GB
Minimum: x64 Processor: 1.4 GHz
x64 Processor: AMD Opteron, AMD Athlon 64, Intel Xeon with Intel EM64T support, Intel Pentium IV with EM64T support

- Ambientes o plataformas en las que pueden operar.

Windows, Linux y contenedores Docker

- Costos de implementación y mantenimiento.

Enterprise $14,256
Standard: por núcleo $3,717 
Standard - servidor + CAL $931

- Ventajas y desventajas de su uso.

Ventajas: es muy rápido y estable.
El engine ofrece la habilidad de ajustar y monitorear niveles de performance, lo que puede reducir el uso de recursos.
Se puede acceder a las visualizaciones desde dispositivos móviles.
Funciona muy bien con otros productos de Microsoft.

Desventajas: El precio para manejo de una empresa
Puede llegar a usar muchísimos recursos.
Muchos tienen problemas usando el SQL Server Integration Services para importar archivos.


- Porcentaje del mercado que controlan

18.07%

############## MySql #####################

- Requerimientos Generales de Hardware

2 CPU Cores
2 GB RAM
Disk I/O subsystem applicable to a write-intensive database

- Ambientes o plataformas en las que pueden operar.

Linux x86 32-bit
Linux x86 64-bit
Mac OS X
Solaris x86 64-bit
Solaris Sparc 64-bit
Free BSD
Windows x86 32-bit
Windows x86 64-bit

- Costos de implementación y mantenimiento.

MySQL Standard Edition USD 2,000 ANUAL
MySQL Enterprise Edition USD 5,000 ANUAL

- Ventajas y desventajas de su uso.

Ventajas: Está disponible de manera gratuita.
Ofrece mucha funcionalidad incluso para una base de datos gratis.
Hay una gran variedad de interfaces de usuario que pueden ser implementadas.
Puede hacerse funcionar con otras bases de datos, incluyendo DB2 y Oracle.

Desventajas: Puede que gastes mucho tiempo y esfuerzo en lograr que MySQL haga cosas que otros sistemas hacen automáticamente, como crear backups incrementales.
No hay soporte integrado para XML ni OLAP.
Hay soporte disponible para la versión gratis, pero debe pagarse.

- Porcentaje del mercado que controlan

15.35%

############## DBMS No relacional: MongoDB #####################

- Requerimientos Generales de Hardware

50% of (RAM - 1 GB), or
256 MB.
x86/x86_64 processors

- Ambientes o plataformas en las que pueden operar.

Amazon Linux 2
Debian 9 and 10
RHEL / CentOS 6, 7, and 8
SLES 12 and 15
Ubuntu LTS 16.04, 18.04, and 20.04
Windows Server 2016 and 2019

- Costos de implementación y mantenimiento.

Shared Clusters: Free
Dedicated Clusters: 57 USD /month
Dedicated Multi-Region Clusters: $95 USD/month

- Ventajas y desventajas de su uso.

Ventajas: es rápido y fácil de usar.
El engine soporta JSON y otros documentos NoSQL
Datos de cualquier estructura pueden ser almacenados y acusados fácil y rápidamente.
Los esquemas pueden ser escritos sin downtime.

Desventajas: SQL no se usa como lenguaje de consulta.
Las herramientas para traducir SQL a consultas de MongoDB existen, pero añaden un paso adicional a usar el engine.
El setup puede ser un proceso tardado.
Los settings default no son seguros.

- Porcentaje del mercado que controlan

3.28%

Conclusiones

Es importante conocer las múltiples herramientas y engines que tenemos disponibles para almacenar y manejar los datos, ya que la mejor herramienta será la que mejor se adapte a las necesidades de la organización o empresa, los datos que necesiten manipular y qué tan sofisticadas necesitan que sean las funciones a realizar con ellos.

Es un gran mercado del cual no tenía idea del que existiera tantísima variedad como esta sola investigación me ha dejado ver, y me llama la atención que estando en todos lados, siempre esté de alguna manera oculto o tras bambalinas. Es una gran oportunidad tener el conocimiento de este mundo de las bases de datos.


Fuentes:

- https://docs.oracle.com/cd/E24191_01/common/install/system_requirements.html
- https://blog.capterra.com/how-much-does-database-management-software-cost/#:~:text=Cost%3A%20Vendors%20don't%20often,%2D%2447%2C500%20for%20enterprise%20businesses.
- https://www.keycdn.com/blog/popular-databases
- https://www.fool.com/investing/2016/09/29/despite-the-cloud-oracle-remains-the-database-king.aspx
- https://docs.microsoft.com/en-us/sql/sql-server/install/hardware-and-software-requirements-for-installing-sql-server-ver15?view=sql-server-ver15
- https://www.microsoft.com/es-es/sql-server/sql-server-2017
- https://docs.oracle.com/cd/E19078-01/mysql/mysql-workbench/wb-installing.html
- https://dev.mysql.com/doc/mysql-monitor/4.0/en/system-prereqs-reference.html
https://www.datanyze.com/market-share/databases--272
- https://docs.mongodb.com/manual/administration/production-notes/#hardware-considerations


--------------------CONSULTAS-------------------------

Consulta de un tabla completa

select * from materiales

1000,Varilla 3/16,100.00
1010,Varilla 4/32,115.00
1020,Varilla 3/17,130.00

Reporta 44 renglones


Selección

select * from materiales
where clave=1000

1000,Varilla 3/16,100.00

Reporta 1 renglón


Proyección

select clave,rfc,fecha from entregan

1000,AAAA800101   ,1998-07-08 00:00:00.000
1000,AAAA800101   ,1999-08-08 00:00:00.000
1000,AAAA800101   ,2000-04-06 00:00:00.000

Reporta 132 renglones

Reunión Natural

select * from materiales,entregan
where materiales.clave = entregan.clave

1000,Varilla 3/16,100.00,1000,AAAA800101   ,5000,1998-07-08 00:00:00.000,165.00
1000,Varilla 3/16,100.00,1000,AAAA800101   ,5019,1999-08-08 00:00:00.000,254.00
1000,Varilla 3/16,100.00,1000,AAAA800101   ,5019,2000-04-06 00:00:00.000,7.00


Reporta 132 renglones

Si algún material no se ha entregado ¿Aparecería en el resultado de esta consulta?
No, no aparecería.


Reunión con criterio específico

select * from entregan,proyectos
where entregan.numero <= proyectos.numero

1000,AAAA800101   ,5000,1998-07-08 00:00:00.000,165.00,5000,Vamos Mexico
1200,EEEE800101   ,5000,2000-03-05 00:00:00.000,177.00,5000,Vamos Mexico
1400,AAAA800101   ,5000,2002-03-12 00:00:00.000,382.00,5000,Vamos Mexico

Reporta 1188 renglones

Unión

(select * from entregan where clave=1450)
union
(select * from entregan where clave=1300)

1300,GGGG800101   ,5005,2002-06-10 00:00:00.000,521.00
1300,GGGG800101   ,5005,2003-02-02 00:00:00.000,457.00
1300,GGGG800101   ,5010,2003-01-08 00:00:00.000,119.00

Reporta 3 renglones

¿Cuál sería una consulta que obtuviera el mismo resultado sin usar el operador Unión? Compruébalo.

SELECT *
FROM Entregan
WHERE Clave=1450 OR Clave=1300

1300,GGGG800101   ,5005,2002-06-10 00:00:00.000,521.00
1300,GGGG800101   ,5005,2003-02-02 00:00:00.000,457.00
1300,GGGG800101   ,5010,2003-01-08 00:00:00.000,119.00

Reporta 3 renglones

Intersección

(select clave from entregan where numero=5001)
intersect
(select clave from entregan where numero=5018)

1010

Reporta 1 renglón

Diferencia

select * from entregan
WHERE Clave!=1000

1010,BBBB800101   ,5001,2000-05-03 00:00:00.000,528.00
1010,BBBB800101   ,5018,2000-11-10 00:00:00.000,667.00
1010,BBBB800101   ,5018,2002-03-29 00:00:00.000,523.00

Reporta 129 renglones

Producto cartesiano

select * from entregan,materiales

1090,BBBB800101   ,5010,1998-01-03 00:00:00.000,421.00,1400,Pintura C1011,125.00
1090,BBBB800101   ,5010,1998-06-06 00:00:00.000,612.00,1400,Pintura C1011,125.00
1100,CCCC800101   ,5009,2000-08-06 00:00:00.000,466.00,1400,Pintura C1011,125.00

Reporta 5808 renglones

¿Cómo está definido el número de tuplas de este resultado en términos del número de tuplas de entregan y de materiales?

Entregan tiene 132 tuplas y Materiales tiene 44. 132 * 44 = 5808. 5808 es resultado de la multiplicación del número de duplas de ambas tablas.

Construcción de consultas a partir de una especificación

Plantea ahora una consulta para obtener las descripciones de los materiales entregados en el año 2000.

SET DATEFORMAT dmy
SELECT M.Descripcion
FROM Entregan E, Materiales M
WHERE E.Fecha >= '01/01/00' AND E.Fecha <= '31/12/00' AND E.Clave = M.Clave

Varilla 3/16
Varilla 4/32
Varilla 4/32
Varilla 4/33
Varilla 3/18

Reporta 28 renglones

¿Por qué aparecen varias veces algunas descripciones de material?
Porque esos materiales fueron entregados varias veces a lo largo del año, en diferentes fechas.

Uso del calificador distinct

SET DATEFORMAT dmy
SELECT DISTINCT M.Descripcion
FROM Entregan E, Materiales M
WHERE E.Fecha >= '01/01/00' AND E.Fecha <= '31/12/00' AND E.Clave = M.Clave

Arena
Block
Cantera rosa
Ladrillos grises
Megablock


Reporta 22 renglones

¿Qué resultado obtienes en esta ocasión?
La descripción de los materiales entregados a lo largo del año sin que se repitan.

Ordenamientos

Obtén los números y denominaciones de los proyectos con las fechas y cantidades de sus entregas, ordenadas por número de proyecto, presentando las fechas de la más reciente a la más antigua.

SELECT P.Numero, P.Denominacion, E.Fecha, E.Cantidad
FROM Proyectos P, Entregan E
WHERE P.Numero = E.Numero
ORDER BY P.Numero,E.Fecha DESC

5000,Vamos Mexico,2002-03-12 00:00:00.000,382.00
5000,Vamos Mexico,2000-03-05 00:00:00.000,177.00
5000,Vamos Mexico,1998-07-08 00:00:00.000,165.00
5001,Aztecón,2000-05-03 00:00:00.000,528.00

Reporta 132 renglones

Operadores de cadena

SELECT * FROM productos where Descripcion LIKE 'Si%'

1120,Sillar rosa,100.00
1130,Sillar gris,110.00

Reporta 2 renglones

¿Qué resultado obtienes?
1120,Sillar rosa,100.00
1130,Sillar gris,110.00

Explica qué hace el símbolo '%'.
Busca las coincidencias con los caracteres antes de él (si se usa como sufijo) o después de él (si se usa como prefijo).

¿Qué sucede si la consulta fuera : LIKE 'Si' ?
No se buscarían los registros cuya descripción empezara con 'Si', sino que buscaría la descripción que fuera exclusivamente 'Si'.

¿Qué resultado obtienes?
Una consulta vacía.

Explica a qué se debe este comportamiento.
Se debe a que el operador comodín permite buscar todos los registros de Descripción que comiencen con los caracteres 'Si', sin importar qué tenga el registro después de ellos. Al buscar exclusivamente con 'Si', sin el operador, estamos buscando las coincidencias de registros que se llamen 'Si'.

¿Qué resultado obtienes de ejecutar el siguiente código?
DECLARE @foo varchar(40);
DECLARE @bar varchar(40);
SET @foo = '¿Que resultado';
SET @bar = ' ¿¿¿??? '
SET @foo += ' obtienes?';
PRINT @foo + @bar;

Se obtiene lo siguiente:

[2020-10-05 23:16:34] [S0001] ¿Que resultado obtienes? ¿¿¿???

¿Para qué sirve DECLARE?
Para declarar variables en SQL y poder almacenar datos temporalmente.

¿Cuál es la función de @foo?
Guardar un String de extensión 40 y concatenar otro String ('¿Que resultado' y ' obtienes?', respectivamente)

¿Que realiza el operador SET?
Le asigna un valor inicial a la variable


Ahora explica el comportamiento, función y resultado de cada una de las siguientes consultas:

SELECT RFC FROM Entregan WHERE RFC LIKE '[A-D]%';

AAAA800101   
AAAA800101   
AAAA800101   
BBBB800101   

Reporta 72 renglones

La consulta selecciona los RFCs que comiencen con los caracteres A, B, C o D de todos los registros que fueron entregados. Al usar el operador % después del conjunto de A a D, puede devolver todos los que empiezan con esas letras.

SELECT RFC FROM Entregan WHERE RFC LIKE '[^A]%';

BBBB800101   
BBBB800101   
BBBB800101   
CCCC800101   

Reporta 114 renglones

La consulta selecciona los RFCs que no comiencen con el carácter A de todos los registros que fueron entregados. Al usar el operador [^] con %, podemos especificar que la primera letra no sea A, pero todo lo demás puede ser cualquier secuencia de caracteres con cualquier contenido.

SELECT Numero FROM Entregan WHERE Numero LIKE '___6';

5016
5016
5006
5006

Reporta 14 renglones

La consulta selecciona los Números de los Materiales entregados cuyo cuarto número sea 6. Al usar tres guiones bajos, dejamos que los otros números pueden ser cualquier otro, pero el cuarto debe coincidir con 6 y seleccionamos el correspondiente.


BETWEEN Es un operador para especificar intervalos. Una aplicación muy común de dicho operador son intervalos de fechas.

SELECT Clave,RFC,Numero,Fecha,Cantidad
FROM Entregan
WHERE Numero Between 5000 and 5010;

1000,AAAA800101   ,5000,1998-07-08 00:00:00.000,165.00
1010,BBBB800101   ,5001,2000-05-03 00:00:00.000,528.00
1020,CCCC800101   ,5002,2001-07-29 00:00:00.000,582.00
1030,DDDD800101   ,5003,1998-02-21 00:00:00.000,202.00

Reporta 60 renglones.

¿Cómo filtrarías rangos de fechas?
Usando el operador Between para indicar un rango de fechas y añadiendo operadores AND a la condición para escribir más BETWEENS y permitir más registros dentro de otras fechas.

EXISTS Se utiliza para especificar dentro de una subconsulta la existencia de ciertas filas.

SELECT RFC,Cantidad, Fecha,Numero
FROM [Entregan]
WHERE [Numero] Between 5000 and 5010 AND
Exists ( SELECT [RFC]
FROM [Proveedores]
WHERE RazonSocial LIKE 'La%' and [Entregan].[RFC] = [Proveedores].[RFC] )

AAAA800101   ,441.00,2002-05-03 00:00:00.000,5010
CCCC800101   ,603.00,1998-04-07 00:00:00.000,5002
CCCC800101   ,278.00,2000-08-02 00:00:00.000,5008


Reporta 16 renglones

¿Qué hace la consulta?
Selecciona el RFC, Cantidad, Fecha y Número de los registros de materiales entregados cuyo número esté entre 5000 y 5010, y que además cuyo registro de RFC coincida con un Proveedor cuya razón social comience con 'La'.

¿Qué función tiene el paréntesis ( ) después de EXISTS?
Especificar la subconsulta en donde se van a buscar la consulta precedente.


Tomando de base la consulta anterior del EXISTS, realiza el query que devuelva el mismo resultado, pero usando el operador IN

SELECT RFC, Cantidad, Fecha, Numero
FROM Entregan
WHERE Numero between 5000 and 5010 AND RFC IN (
    SELECT RFC
    FROM Proveedores
    WHERE RazonSocial LIKE 'La%' and Entregan.RFC = Proveedores.RFC
    )

Tomando de base la consulta anterior del EXISTS, realiza el query que devuelva el mismo resultado, pero usando el operador NOT IN 

SELECT RFC, Cantidad, Fecha, Numero
FROM Entregan
WHERE Numero BETWEEN 5000 AND 5010 AND RFC NOT IN(
    SELECT RFC
    FROM Proveedores
    WHERE RazonSocial NOT LIKE 'La%' and Entregan.RFC= Proveedores.RFC
    )

AAAA800101   ,165.00,1998-07-08 00:00:00.000,5000
CCCC800101   ,582.00,2001-07-29 00:00:00.000,5002
AAAA800101   ,86.00,1999-01-12 00:00:00.000,5008
CCCC800101   ,466.00,2000-08-06 00:00:00.000,5009

Reporta 16 renglones


Realiza un ejemplo donde apliques algún operador : ALL, SOME o ANY.

SELECT RazonSocial
from Proveedores
WHERE RFC = ANY (SELECT RFC FROM Entregan WHERE RFC LIKE 'B%')

Oviedo

Reporta 1 renglón


¿Qué hace la siguiente sentencia? Explica por qué.
Reporta los 2 primeros registros de Proyectos de la lista, ya que están ordenados por número de manera ascendente, son los dos con valor de número menor. Usa el operador TOP al que se le especifica tomar los primeros 2.

SELECT TOP 2 * FROM Proyectos

5000,Vamos Mexico
5001,Aztecón

Reporta 2 renglones

¿Qué sucede con la siguiente consulta? Explica por qué.
No funciona. Porque el operador TOP necesita un parámetro numérico para saber cuántos registros va a seleccionar. No estamos pasándole un parámetro numérico.

SELECT TOP Numero FROM Proyectos

¿Qué consulta usarías para obtener el importe de las entregas es decir, el total en dinero de lo entregado, basado en la cantidad de la entrega y el precio del material y el impuesto asignado?

CREATE VIEW PRECIOSTOTALES AS(
SELECT Clave,
        Costo+(Costo*PorcentajeImpuesto/100) AS PrecioTotal
FROM Materiales)

SELECT SUM(E.Cantidad*P.PrecioTotal) AS ImporteTotal
FROM PRECIOSTOTALES P, Entregan E
WHERE P.Clave = E.Clave

10953961.3574000000

Reporta 1 renglón

VISTAS CREADAS


Los materiales (clave y descripción) entregados al proyecto "México sin ti no estamos completos".

SELECT M.Clave, M.Descripcion
FROM Entregan E, Materiales M, Proyectos P
WHERE E.Clave=M.Clave AND P.Numero=E.Numero AND P.Denominacion LIKE 'Mexico sin ti no estamos completos'

1030,Varilla 4/33
1230,Cemento 
1430,Pintura B1022

Reporta 3 renglones

Los materiales (clave y descripción) que han sido proporcionados por el proveedor "Acme tools".

SELECT M.Clave, M.Descripcion
FROM Entregan E, Materiales M, Proveedores P
WHERE E.Clave=M.Clave AND P.RFC=E.RFC AND P.RazonSocial LIKE 'Acme tools'

Reporta 0 renglones, tabla vacía.

El RFC de los proveedores que durante el 2000 entregaron en promedio cuando menos 300 materiales.

SET DATEFORMAT dmy
SELECT DISTINCT E.RFC
FROM Entregan E
WHERE E.Fecha BETWEEN '01/01/00' AND '31/12/00' AND EXISTS (
    SELECT E.RFC, AVG(E.Cantidad) AS CantPromedio
    FROM Proveedores P,
         Entregan E
    WHERE P.RFC = E.RFC
    GROUP BY E.RFC
    HAVING AVG(E.Cantidad) >= 300
)

AAAA800101   
BBBB800101   
CCCC800101   

Reporta 8 renglones

El Total entregado por cada material en el año 2000.

SET DATEFORMAT dmy
SELECT E.Clave, SUM(E.Cantidad) AS TotalEntregado
FROM Entregan E
WHERE E.Fecha BETWEEN '01/01/00' AND '31/12/00'
GROUP BY E.Clave

1000,7.00
1010,1195.00
1030,295.00

Reporta 22 renglones

La Clave del material más vendido durante el 2001. (se recomienda usar una vista intermedia para su solución)

CREATE VIEW SUMVendidos2001 AS(
        SELECT E.Clave, SUM(E.Cantidad) AS TotalEntregado
        FROM Entregan E
        WHERE E.Fecha BETWEEN '2001-01-01' AND '2001-12-31'
        GROUP BY E.Clave )

        SELECT TOP 1 S.Clave
        FROM SUMVendidos2001 S
        ORDER BY TotalEntregado DESC

1020

Reporta 1 renglón


Productos que contienen el patrón 'ub' en su nombre.

SELECT Descripcion, Clave
FROM Materiales
WHERE Descripcion LIKE '%ub%'

Recubrimiento P1001,1180
Recubrimiento P1010,1190
Recubrimiento P1019,1200

Reporta 12 renglones

Denominación y suma del total a pagar para todos los proyectos.


CREATE VIEW PRECIOSTOTALES AS(
SELECT Clave,
        Costo+(Costo*PorcentajeImpuesto/100) AS PrecioTotal
FROM Materiales)

CREATE VIEW CANTIDADESPORPROYECTO AS(
SELECT DISTINCT Clave, Numero, SUM(Cantidad) AS CantidadProyecto
FROM Entregan
GROUP BY Numero, Clave)

CREATE VIEW COSTOMATERIALPROYECTO AS(
SELECT Pr.Denominacion, P.Clave, C.CantidadProyecto*P.PrecioTotal AS CostoProyecto
FROM PRECIOSTOTALES P, CANTIDADESPORPROYECTO C, Proyectos Pr
WHERE P.Clave = C.Clave AND C.Numero=Pr.Numero
)

SELECT Denominacion, SUM(CostoProyecto) AS COSTOTOTAL
FROM COSTOMATERIALPROYECTO
GROUP BY Denominacion

Ampliación de la carretera a la huasteca,742461.194000
Aztecón,150200.219000
CIT Campeche,161603.082000

Reporta 20 renglones

Denominación, RFC y RazonSocial de los proveedores que se suministran materiales al proyecto Televisa en acción que no se encuentran apoyando al proyecto Educando en Coahuila (Solo usando vistas).

CREATE VIEW RFC_CON_TELEVISA AS
(
SELECT DISTINCT E.RFC
FROM Proyectos Pr,
     Entregan E,
     Proveedores P
WHERE Pr.Numero = E.Numero
  AND P.RFC = E.RFC
  AND Denominacion = 'Televisa en acción'
    )

CREATE VIEW RFC_CON_EDUCOAHUILA AS (
SELECT DISTINCT E.RFC
FROM Proyectos Pr,
     Entregan E,
     Proveedores P
WHERE Pr.Numero = E.Numero
  AND P.RFC = E.RFC
  AND Denominacion = 'Educando en Coahuila'
)

CREATE VIEW TELEVISA_NOCOAHUILA  AS (
SELECT DISTINCT Pr.Denominacion, P.RFC, P.RazonSocial
FROM Proveedores P, Proyectos Pr, Entregan E
WHERE E.RFC = P.RFC AND Pr.Numero=E.Numero AND E.RFC IN (SELECT * FROM RFC_CON_TELEVISA) AND E.RFC NOT IN (SELECT * FROM RFC_CON_EDUCOAHUILA)
) AND E.RFC NOT IN (SELECT * FROM RFC_CON_EDUCOAHUILA)

Ampliación de la carretera a la huasteca,CCCC800101   ,La Ferre
Ampliación de la carretera a la huasteca,DDDD800101   ,Cecoferre
CIT Campeche,CCCC800101   ,La Ferre

Reporta 16 renglones

Denominación, RFC y RazonSocial de los proveedores que se suministran materiales al proyecto Televisa en acción que no se encuentran apoyando al proyecto Educando en Coahuila (Sin usar vistas, utiliza not in, in o exists).

SELECT DISTINCT Pr.Denominacion, P.RFC, P.RazonSocial
FROM Proveedores P, Proyectos Pr, Entregan E
WHERE E.RFC = P.RFC AND Pr.Numero=E.Numero AND E.RFC IN(
SELECT DISTINCT E.RFC
FROM Proyectos Pr,
     Entregan E,
     Proveedores P
WHERE Pr.Numero = E.Numero
  AND P.RFC = E.RFC
  AND Denominacion = 'Televisa en acción'
    ) AND E.RFC NOT IN (
        SELECT DISTINCT E.RFC
FROM Proyectos Pr,
     Entregan E,
     Proveedores P
WHERE Pr.Numero = E.Numero
  AND P.RFC = E.RFC
  AND Denominacion = 'Educando en Coahuila'
    )

Ampliación de la carretera a la huasteca,CCCC800101   ,La Ferre
Ampliación de la carretera a la huasteca,DDDD800101   ,Cecoferre
CIT Campeche,CCCC800101   ,La Ferre

Reporta 16 renglones

Costo de los materiales y los Materiales que son entregados al proyecto Televisa en acción cuyos proveedores también suministran materiales al proyecto Educando en Coahuila.

SELECT DISTINCT M.Costo, M.Descripcion
FROM Proyectos Pr, Entregan E, Materiales M
WHERE Pr.Numero=E.Numero AND E.Clave=M.Clave AND Pr.Denominacion= 'Televisa en acción' AND E.RFC IN(
    SELECT DISTINCT E.RFC
    FROM Proyectos Pr,
     Entregan E
    WHERE Pr.Numero = E.Numero
     AND Denominacion = 'Educando en Coahuila'
    )

34.00,Tepetate
50.00,Ladrillos rojos

Reporta 2 renglones

Nombre del material, cantidad de veces entregados y total del costo de dichas entregas por material de todos los proyectos.

CREATE VIEW VECESENTREGADOS AS(
SELECT E.Clave, M.Descripcion, COUNT(E.Clave) AS VECESENTREGADO
FROM Entregan E, Materiales M
WHERE E.Clave= M.Clave
GROUP BY M.Descripcion, E.Clave)

CREATE VIEW COSTOPORMATERIAL AS(
SELECT M.Clave, SUM(M.Costo*E.Cantidad) AS COSTOPORMATERIAL
FROM Materiales M, Entregan E
WHERE M.Clave = E.Clave
GROUP BY M.Clave)

SELECT V.Descripcion, V.VECESENTREGADO, C.COSTOPORMATERIAL
FROM COSTOPORMATERIAL C, VECESENTREGADOS V
WHERE C.Clave = V.Clave

Varilla 3/16,3,42600.0000
Varilla 4/32,3,197570.0000
Varilla 3/17,3,138840.0000

Reporta 44 renglones





